>
(function(e){function t(t){for(var s,i,a=t[0],l=t[1],d=t[2],p=0,u=[];p<a.length;p++)i=a[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&u.push(o[i][0]),o[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);c&&c(t);while(u.length)u.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],s=!0,a=1;a<n.length;a++){var l=n[a];0!==o[l]&&(s=!1)}s&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var s={},o={app:0},r=[];function i(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=s,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="app://./";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var d=0;d<a.length;d++)t(a[d]);var c=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("85ec")},"1a29":function(e,t,n){"use strict";n("3330")},2849:function(e,t){e.exports=require("http")},3330:function(e,t,n){},"34bb":function(e,t){e.exports=require("electron")},"41db":function(e,t){e.exports=require("child_process")},"4a5d":function(e,t,n){"use strict";n("d2a7")},"56d7":function(e,t,n){"use strict";n.r(t);var s=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showProgress,expression:"showProgress"}],staticClass:" flex items-center justify-center h-screen",staticStyle:{"background-color":"#BEBEBE"}},[n("ProgressBar",{staticStyle:{position:"absolute",top:"20%"},attrs:{percentageJava:e.percentageJava,percentageDotnet:e.percentageDotnet},on:{ignore:e.ignoreDownload}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.gettingUpdate,expression:"gettingUpdate"}],staticClass:" flex items-center justify-center h-screen",staticStyle:{"background-color":"#BEBEBE"}},[n("Loader",{attrs:{"is-loading":e.gettingUpdate}}),e._v(" updating to new version... ")],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.gettingUpdate&&!e.finishWebLoading,expression:"!gettingUpdate &&  !finishWebLoading"}],staticClass:" flex items-center justify-center h-screen",staticStyle:{"background-color":"#BEBEBE"}},[n("Loader",{attrs:{"is-loading":!e.finishWebLoading}}),e._v(" loading web content... ")],1),e.iFrameLoad?e._e():n("div",{staticClass:" flex h-screen"},[n("button",{staticClass:"w-1/5 h-12 rounded-sm text-white text-xs m-auto",staticStyle:{"background-color":"#E40046"},on:{click:e.handleError}},[e._v("RESET")])]),e.webURL?n("iframe",{directives:[{name:"show",rawName:"v-show",value:!e.showProgress&&e.finishWebLoading,expression:"!showProgress && finishWebLoading"}],staticStyle:{width:"100%",height:"100vh",border:"none"},attrs:{id:"iframetext",src:e.webURL},on:{load:e.handleFinishLoading,error:e.handleError}}):e._e(),n("div",{attrs:{id:"dialogLocationApp"}})])},r=[],i=n("34bb");const a={SET_DEFAULT_PRINTER:"SET_DEFAULT_PRINTER",SET_DEFAULT_SCANNER:"SET_DEFAULT_SCANNER",SET_THERMAL_PRINTER_OPTION:"SET_THERMAL_PRINTER_OPTION",SET_DOWNLOADING_DEPENDENCY_JAVA:"SET_DOWNLOADING_DEPENDENCY_JAVA",SET_DOWNLOADING_DEPENDENCY_DOTNET:"SET_DOWNLOADING_DEPENDENCY_DOTNET",SET_SESSION_AUTH:"SET_SESSION_AUTH",SET_AUTH_TOKEN:"SET_AUTH_TOKEN",SET_SESSION_ID:"SET_SESSION_ID"};var l=n("2ef0"),d=n.n(l),c=n("a32b"),p=n.n(c),u=n("41a2"),h=n.n(u),f=n("abaf"),m=n("9b0f"),g=n.n(m);const v={defaultPrinter:null,defaultScanner:null,thermalPrinterOption:null},w={[a.SET_DEFAULT_PRINTER](e,t){e.defaultPrinter=t},[a.SET_DEFAULT_SCANNER](e,t){e.defaultScanner=t},[a.SET_THERMAL_PRINTER_OPTION](e,t){e.thermalPrinterOption=t}},E={[a.SET_DEFAULT_PRINTER]({commit:e},t){e(a.SET_DEFAULT_PRINTER,t)},[a.SET_DEFAULT_SCANNER]({commit:e},t){e(a.SET_DEFAULT_SCANNER,t)},[a.SET_THERMAL_PRINTER_OPTION]({commit:e},t){e(a.SET_THERMAL_PRINTER_OPTION,t)}};async function D(e,t){const n=new f["a"],s=await n.acquire();var o={};try{if(g.a.existsSync(S())||g.a.mkdirSync(S()),g.a.existsSync(y())||g.a.mkdirSync(y()),g.a.existsSync(R())){var r=g.a.readFileSync(R());o=JSON.parse(r)}}catch(i){console.log("config: "+i)}o[e]=t,g.a.writeFileSync(R(),JSON.stringify(o)),s()}async function T(e){const t=new f["a"],n=await t.acquire();try{var s=null;if(g.a.existsSync(S())||g.a.mkdirSync(S()),g.a.existsSync(y())||g.a.mkdirSync(y()),g.a.existsSync(R())){var o=g.a.readFileSync(R());s=JSON.parse(o)}return s[e]}catch(r){console.log("config: "+r)}return n(),null}function R(){var e=p.a.join(h()().split("\\").slice(0,-1).join("\\"),"Local\\whishmoney-updater\\Settings.txt");return e}function S(){var e=p.a.join(h()().split("\\").slice(0,-1).join("\\"),"Local");return e}function y(){var e=p.a.join(h()().split("\\").slice(0,-1).join("\\"),"Local\\whishmoney-updater");return e}var b={namespaced:!0,state:v,actions:E,mutations:w,put:D,get:T,getters:{defaultPrinter:e=>e.defaultPrinter,defaultScanner:e=>e.defaultScanner,thermalPrinterOption:e=>e.thermalPrinterOption}},_=n("2f62"),I=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"overlay absolute top-0 left-0 w-full h-full flex items-center justify-center"},[n("div",{staticClass:"box bg-white rounded overflow-hidden w-4/12"},[e._m(0),n("div",{staticClass:"p-5 bg-gray-300 border-t border-gray-600 text-lg"},[e._v(" Please download JAVA, run its setup in the Downloads folder, and then restart your computer ")]),n("div",{staticClass:"flex flex-row h-12"},[n("button",{staticClass:"flex-1 bg-green-500 text-white font-bold hover:bg-gray-600 submitButton",attrs:{disabled:e.downloading},on:{click:function(t){return t.preventDefault(),e.onConfirm.apply(null,arguments)}}},[e._v(" Proceed ")])])])])},N=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"p-4  flex bg-gray-300 items-center "},[n("h2",{staticClass:"flex-grow text-2xl font-bold  text-center"},[e._v("JAVA REQUIRED")])])}];const C={downloadingDependencyJava:null,downloadingDependencyDotnet:null,authToken:null,sessionId:null},x={[a.SET_DOWNLOADING_DEPENDENCY_JAVA](e,t){e.downloadingDependencyJava=t},[a.SET_DOWNLOADING_DEPENDENCY_DOTNET](e,t){e.downloadingDependencyDotnet=t},[a.SET_SESSION_AUTH](e,t){e.authToken=t.token,e.sessionId=t.sessionId},[a.SET_AUTH_TOKEN](e,t){e.authToken=t},[a.SET_SESSION_ID](e,t){e.sessionId=t}},P={[a.SET_DOWNLOADING_DEPENDENCY_JAVA]({commit:e},t){e(a.SET_DOWNLOADING_DEPENDENCY_JAVA,t)},[a.SET_DOWNLOADING_DEPENDENCY_DOTNET]({commit:e},t){e(a.SET_DOWNLOADING_DEPENDENCY_DOTNET,t)},[a.SET_AUTH_TOKEN]({commit:e},t){e(a.SET_AUTH_TOKEN,t)},[a.SET_SESSION_ID]({commit:e},t){e(a.SET_SESSION_ID,t)},[a.SET_SESSION_AUTH]({commit:e},t){e(a.SET_AUTH_TOKEN,t.token),e(a.SET_SESSION_ID,t.sessionId)}};var L={namespaced:!0,state:C,mutations:x,actions:P};s["a"].use(_["b"]);var A=new _["b"].Store({modules:{settings:b,auth:L},plugins:[],strict:!1}),O={name:"DownloadJavaModal",props:{onConfirm:Function},computed:{downloading:function(){return A.state.auth.downloadingDependencyJava}}},F=O,U=(n("4a5d"),n("2877")),J=Object(U["a"])(F,I,N,!1,null,"7fdf1b11",null),j=J.exports,k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"overlay absolute top-0 left-0 w-full h-full flex items-center justify-center "},[n("div",{staticClass:"box bg-white rounded overflow-hidden w-4/12"},[e._m(0),n("div",{staticClass:"p-5 bg-gray-300 border-t border-gray-600 text-lg"},[e._v(" Please install the required library for scanning after pressing PROCEED ")]),n("div",{staticClass:"flex flex-row h-12"},[n("button",{staticClass:"flex-1 bg-green-500 text-white hover:bg-gray-600 submitButton",attrs:{disabled:e.downloading},on:{click:function(t){return t.preventDefault(),e.onConfirm.apply(null,arguments)}}},[e._v(" Proceed ")]),n("button",{staticClass:"flex-1 bg-red-500 text-white hover:bg-gray-600",on:{click:function(t){return t.preventDefault(),e.onDecline.apply(null,arguments)}}},[e._v(" Cancel ")])])])])},M=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"p-4  flex bg-gray-300 items-center "},[n("h2",{staticClass:"flex-grow text-2xl font-bold  text-center"},[e._v("LIBRARY INSTALLATION REQUIRED")])])}],B={name:"DownloadDotNetModal",props:{onConfirm:Function,onDecline:Function},computed:{downloading:function(){return A.state.auth.downloadingDependencyDotnet}}},q=B,W=(n("1a29"),Object(U["a"])(q,k,M,!1,null,"5620443b",null)),$=W.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"absolute w-5/12 flex h-1/12 draggable",staticStyle:{"z-index":"100000!important",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},on:{"~mouseover":function(t){return e.drag(t)}}},[n("div",{staticClass:"box bg-white rounded w-full overflow-hidden"},[n("div",{staticClass:"p-4 flex bg-gray-300 items-center "},[n("h2",{staticClass:"flex-grow text-2xl font-bold  text-center"},[e._v(e._s(e.title))])]),n("div",{staticClass:"p-5 bg-gray-300 border-t border-gray-600 text-xl"},[e._v(" "+e._s(e.body)+" ")]),n("div",{staticClass:"flex flex-row h-12"},[n("button",{staticClass:"flex-1 bg-green-500 text-white hover:bg-gray-600 ",on:{click:function(t){return t.preventDefault(),e.onConfirm.apply(null,arguments)}}},[e._v(e._s(e.confirmationTitle))])])])])},Y=[],G={name:"ConfirmationDialogue",props:{title:String,body:String,confirmationTitle:String,onConfirm:Function},data(){return{}},methods:{drag(){for(var e of document.getElementsByClassName("draggable"))t(e);function t(e){var t=0,n=0,s=0,o=0;function r(e){e=e||window.event,e.preventDefault(),s=e.clientX,o=e.clientY,document.onmouseup=a,document.onmousemove=i}function i(r){r=r||window.event,r.preventDefault(),t=s-r.clientX,n=o-r.clientY,s=r.clientX,o=r.clientY,e.style.top=e.offsetTop-n+"px",e.style.left=e.offsetLeft-t+"px"}function a(){document.onmouseup=null,document.onmousemove=null}e&&(e.onmousedown=r)}}}},V=G,K=Object(U["a"])(V,H,Y,!1,null,null,null),z=K.exports;const X={showDownloadJavaModal(){return new Promise((e,t)=>{const n=s["a"].extend(j),o=new n({propsData:{onConfirm:()=>{o.$destroy(!0),o.$el.remove(),e(!0)}}});o.$mount(),document.getElementById("dialogLocationApp").appendChild(o.$el)})},showDownloadDotNetModal(){return new Promise((e,t)=>{const n=s["a"].extend($),o=new n({propsData:{onConfirm:()=>{o.$destroy(!0),o.$el.remove(),e(!0)},onDecline:()=>{o.$destroy(!0),o.$el.remove(),e(!1)}}});o.$mount(),document.getElementById("dialogLocationApp").appendChild(o.$el)})},showPrinterDialog({title:e,body:t,confirmationTitle:n="Yes"}){return new Promise((o,r)=>{const i=s["a"].extend(z),a=new i({propsData:{title:e,body:t,confirmationTitle:n,onConfirm:()=>{a.$destroy(!0),a.$el.remove(),o(!0)}}});a.$mount(),document.getElementById("dialogLocationApp").appendChild(a.$el)})}};n("845f");var Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.downloadingJava?n("div",{staticClass:"bar"},[n("div",{staticClass:"bar-inner",style:{width:e.percentageJava+"%"},attrs:{"data-percent":e.percentageJava+"%"}}),e._m(0)]):e._e(),e.downloadingDotnet?n("div",{staticClass:"bar"},[n("div",{staticClass:"bar-inner",style:{width:e.percentageDotnet+"%"},attrs:{"data-percent":e.percentageDotnet+"%"}}),e._m(1)]):e._e(),n("div",{attrs:{id:"second"}},[n("button",{staticClass:"w-full h-8 mt-2 bg-blue-800 text-white",staticStyle:{"padding-right":"15px","padding-left":"15px",float:"right"},on:{click:e.ignore}},[e._v(" Ignore ")])])])},Z=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"wrapper"}},[n("div",{attrs:{id:"first"}},[n("p",[e._v("Downloading Java files...")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"wrapper"}},[n("div",{attrs:{id:"first"}},[n("p",[e._v("Downloading Dotnet files...")])])])}],ee={name:"ProgressBar",props:["percentageJava","percentageDotnet"],methods:{ignore(){this.$emit("ignore")}},computed:{downloadingJava:function(){return A.state.auth.downloadingDependencyJava},downloadingDotnet:function(){return A.state.auth.downloadingDependencyDotnet}}},te=ee,ne=(n("aed0"),Object(U["a"])(te,Q,Z,!1,null,"77414e40",null)),se=ne.exports,oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isLoading?s("div",{staticClass:"loader absolute w-full h-full  left-0 z-50 flex items-center justify-center",staticStyle:{top:"64px"}},[s("img",{staticClass:"w-20",attrs:{src:n("6e70"),alt:""}})]):e._e()},re=[],ie={name:"Loader",props:{isLoading:{type:Boolean,default:!1}}},ae=ie,le=(n("74ae"),Object(U["a"])(ae,oe,re,!1,null,null,null)),de=le.exports;const{mapActions:ce}=Object(_["a"])("auth");var pe={data(){return{iFrameLoad:!1,showProgress:!1,finishWebLoading:!1,percentageJava:0,percentageDotnet:0,downloadInfo:0,process:process,gettingUpdate:!0===JSON.parse(sessionStorage.getItem("gettingUpdate")),registeredServiceWorker:!1,webURL:!1,iFrameError:!1}},components:{ProgressBar:se,Loader:de},mounted(){let e=document.getElementById("iframetext");e&&e.contentWindow&&(e.contentWindow.console.error=(...e)=>{this.iFrameLoad=!1,setTimeout(()=>{i["ipcRenderer"].send("open-web-browser")},45e3),console.log(e);for(const t of e){let e="";t.message&&(e+=""+t.message),t.stack&&(e+=""+t.stack),console.error(""+e)}})},methods:{handleError(){let e=n("a32b"),t=n("9b0f");var s=e.join(h()().split("\\").slice(0,-1).join("\\"),"Roaming\\whishmoney\\Cache");console.log(s),t.readdir(s,(n,o)=>{if(n)throw n;for(const r of o)t.unlink(e.join(s,r),e=>{if(e)throw e})}),i["ipcRenderer"].send("requestReload")},handleFinishLoading(){sessionStorage.setItem("gettingUpdate",!1),this.gettingUpdate=!1,this.finishWebLoading=!0;let e=!1,t=setInterval(()=>{(e||this.registeredServiceWorker)&&(i["ipcRenderer"].send("open-web-browser"),clearInterval(t))},1e3)},...ce({setDownloadingDependencyJava:a.SET_DOWNLOADING_DEPENDENCY_JAVA,setDownloadingDependencyDotnet:a.SET_DOWNLOADING_DEPENDENCY_DOTNET,setAuthDetails:a.SET_SESSION_AUTH}),sendToChildIframe(e,t){const n={message:e,listenerId:t};document.getElementById("iframetext").contentWindow.postMessage(JSON.stringify(n),"*")},setResponse(e,t,n=null){return{command:e,data:t,options:n}},setDependencies(e,t){"java"==e?(this.percentageJava=0,this.setDownloadingDependencyJava(t)):"dotnet"==e&&(this.percentageDotnet=0,this.setDownloadingDependencyDotnet(t))},downloadManagerJava(e,t){this.showProgress=!0;let s=e.split("/")[e.split("/").length-1];var o=s.split(".")[0];this.setDependencies(o,!0),i["ipcRenderer"].send("download-java",e),i["ipcRenderer"].once("download-java-success",(e,s,r)=>{i["ipcRenderer"].removeAllListeners("download-java-error"),i["ipcRenderer"].removeAllListeners("download-java-success"),i["ipcRenderer"].removeAllListeners("download-java-progress"),this.setDependencies(o,!1);let a=this.setResponse("notification",{type:"success",message:r,title:""});this.sendToChildIframe(a,t),console.log("Downloaded file:"+s),0==this.percentageDotnet&&(this.showProgress=!1);const{exec:l}=n("41db");l(s,(e,t,n)=>{e?console.error("error: "+e.message):n?console.error("stderr: "+n):console.log("stdout: "+t)})}),i["ipcRenderer"].once("download-java-error",(n,s)=>{i["ipcRenderer"].removeAllListeners("download-java-error"),i["ipcRenderer"].removeAllListeners("download-java-success"),i["ipcRenderer"].removeAllListeners("download-java-progress"),console.error(s);let r=this.setResponse("notification",{type:"error",message:"Download failed: "+s+". Retrying...",title:""});this.sendToChildIframe(r,t),this.setDependencies(o,!1),setTimeout(()=>{this.downloadManagerJava(e,t)},6e3)}),this.addProgressListenerJava(o)},downloadManagerDotnet(e,t){this.showProgress=!0;let s=e.split("/")[e.split("/").length-1];var o=s.split(".")[0];this.setDependencies(o,!0),i["ipcRenderer"].send("download-dotnet",e),i["ipcRenderer"].once("download-dotnet-success",(e,s,r)=>{i["ipcRenderer"].removeAllListeners("download-dotnet-error"),i["ipcRenderer"].removeAllListeners("download-dotnet-success"),i["ipcRenderer"].removeAllListeners("download-dotnet-progress"),this.setDependencies(o,!1);let a=this.setResponse("notification",{type:"success",message:r,title:""});this.sendToChildIframe(a,t),console.log("Downloaded file:"+s),0==this.percentageJava&&(this.showProgress=!1);const{exec:l}=n("41db");l(s,(e,t,n)=>{e?console.error("error: "+e.message):n?console.error("stderr: "+n):console.log("stdout: "+t)})}),i["ipcRenderer"].once("download-dotnet-error",(n,s)=>{i["ipcRenderer"].removeAllListeners("download-dotnet-error"),i["ipcRenderer"].removeAllListeners("download-dotnet-success"),i["ipcRenderer"].removeAllListeners("download-dotnet-progress");let r=this.setResponse("notification",{type:"error",message:"Download failed: "+s+". Retrying...",title:""});this.sendToChildIframe(r,t),this.setDependencies(o,!1),setTimeout(()=>{this.downloadManagerDotnet(e,t)},6e3)}),this.addProgressListenerDotnet(o)},setProgressPercentage(e,t){"java"==e&&this.percentageJava<Number(t)?(this.percentageJava=Number(t).toFixed(2),console.log("percentage Java: "+this.percentageJava)):"dotnet"==e&&this.percentageDotnet<Number(t)&&(this.percentageDotnet=Number(t).toFixed(2),console.log("percentage Dotnet: "+this.percentageDotnet))},addProgressListenerJava(e){i["ipcRenderer"].once("download-java-progress",(t,n)=>{this.setProgressPercentage(e,n),setTimeout(()=>{this.addProgressListenerJava(e)},1e3)})},addProgressListenerDotnet(e){i["ipcRenderer"].once("download-dotnet-progress",(t,n)=>{this.setProgressPercentage(e,n),setTimeout(()=>{this.addProgressListenerDotnet(e)},1e3)})},ignoreDownload(){this.showProgress=!1;let e=this.setResponse("notification",{type:"success",message:"Please do not close the application until further notice.",title:"Downloading"});this.sendToChildIframe(e,"machineInfo")}},created(){try{console.log("live");let e=g.a.readFileSync("./configGlobal.json","utf8"),t=JSON.parse(e);console.log("parsed"),console.log(t),this.webURL=t.VUE_APP_WEB_URL}catch(t){console.error("error while reaidng"+t)}const e=n("9cb4");console.error=e.error,window.onmessage=async e=>{if(e.data){try{var s=JSON.parse(e.data),o=s.message,r=s.listenerId}catch(t){}if(console.log("test "+JSON.stringify(o)+" - "+r),o&&(this.iFrameLoad=!0),0==this.iFrameLoad&&setTimeout(()=>{i["ipcRenderer"].send("open-web-browser")},45e3),o&&"refreshPage"==o.command)sessionStorage.setItem("gettingUpdate",!0),i["ipcRenderer"].send("requetRefreshPage"),i["ipcRenderer"].once("responseRefreshPage",e=>{let t=this.setResponse("refreshPage",null);this.sendToChildIframe(t,r)});else if(o&&"getMachineDetails"==o.command){let e=this.setResponse("getMachineDetails",{machineId:null,machineBrand:null,machineModel:null});i["ipcRenderer"].send("machineIdRequest"),i["ipcRenderer"].once("machineIdResponse",(t,n)=>{e.data.machineId=n,i["ipcRenderer"].send("machineBrandRequest")}),i["ipcRenderer"].once("machineBrandRequest",(t,n)=>{e.data.machineBrand=n,i["ipcRenderer"].send("machineModelRequest")}),i["ipcRenderer"].once("machineModelRequest",(t,n)=>{e.data.machineModel=n,this.sendToChildIframe(e,r)})}else if(o&&"getScanners"==o.command){var a=await b.get("scanner");i["ipcRenderer"].send("requestScannersList",o.data.useNewScanner,a),i["ipcRenderer"].on("responseScannersList",async(e,t)=>{var n=t?t[0]:"no";if(console.log("code: "+n),"error"==n)console.log("Scanning Error: "+t),0==this.percentage&&X.showDownloadDotNetModal().then(e=>{e&&this.downloadManagerDotnet("https://woo-install-prerequisites.s3.amazonaws.com/dotnet.exe",r)}).catch(e=>{console.error(e)});else if("error1"==n)console.log("scanner list parsing error catched: "+t);else{var s,o;t?(s=await b.get("useScanner"),a&&t.includes(a)?o=a:0!=t.length&&(o=t[0],await b.put("scanner",o))):(s=!1,console.log("scanners: no scanner"));let e=this.setResponse("getScanners",{scanners:t,defaultScanner:o,useScanner:s});this.sendToChildIframe(e,r)}})}else if(o&&"setDefaultScanner"==o.command)await b.put("scanner",o.data.defaultScanner);else if(o&&"setUseScanner"==o.command)await b.put("useScanner",o.data.useScanner);else if(o&&"getPrinters"==o.command)i["ipcRenderer"].send("requestPrintersList"),i["ipcRenderer"].on("responsePrintersList",async(e,t)=>{var n,s=t.filter(e=>""!==e),o=s.filter(e=>"thermal"!=e.split(" ")[0].toLowerCase()),i=await b.get("printer");i&&o.includes(i)?n=i:o&&0!=o.length&&(n=o[0],await b.put("printer",n));let a=this.setResponse("getPrinters",{printers:o,defaultPrinter:n});this.sendToChildIframe(a,r)});else if(o&&"setDefaultPrinter"==o.command)await b.put("printer",o.data.defaultPrinter);else if(o&&"createExcel"==o.command)i["ipcRenderer"].send("createExcel",{data:o.data.data,fields:o.data.fields});else if(o&&"checkJava"==o.command){var l=n("41db").spawn("java",["-version"]),c=this;l.on("error",(function(e){console.log("java error: "+e),X.showDownloadJavaModal().then(e=>{e&&c.downloadManagerJava("https://woo-install-prerequisites.s3.amazonaws.com/java.exe",r)}).catch(e=>{console.error(e)})}))}else if(o&&"checkDotNet"==o.command){l=n("41db").spawn("dotnet",["--version"]),c=this;l.on("error",(function(e){g.a.existsSync("C:\\Program Files (x86)\\dotnet")||(console.log("dotnet error: "+e),X.showDownloadDotNetModal().then(e=>{e&&c.downloadManagerDotnet("https://woo-install-prerequisites.s3.amazonaws.com/dotnet.exe",r)}).catch(e=>{console.error(e)}))}))}else if(o&&"getAppVersion"==o.command){let e=n("9224").version,t=this.setResponse("setAppVersion",{value:e});this.sendToChildIframe(t,r)}else if(o&&"checkUpdate"==o.command)i["ipcRenderer"].once("updateAvailable",(e,t)=>{let n=this.setResponse("setUpdateInfo",{updateInfo:t});this.sendToChildIframe(n,r),console.log("UPDATE AVAILABLE:"+JSON.stringify(t)),n=this.setResponse("setUpdateAvailable",{value:!0}),this.sendToChildIframe(n,r),n=this.setResponse("setCheckingForUpdate",{value:!1}),this.sendToChildIframe(n,r)}),i["ipcRenderer"].once("updateNotAvailable",(e,t)=>{console.log("UPDATE NOT AVAILABLE: "+t);let n=this.setResponse("notification",{type:"warning",message:"You have the latest version.",title:""});this.sendToChildIframe(n,r),n=this.setResponse("setCheckingForUpdate",{value:!1}),this.sendToChildIframe(n,r)}),i["ipcRenderer"].on("updateError",(e,t)=>{let n=this.setResponse("notification",{type:"error",message:"Something went wrong",title:""});this.sendToChildIframe(n,r),n=this.setResponse("setCheckingForUpdate",{value:!1}),this.sendToChildIframe(n,r),console.log("UPDATE ERROR: "+JSON.stringify(t))}),i["ipcRenderer"].on("updateProgress",(e,t)=>{if(this.downloadInfo<t.percent){this.downloadInfo=Number(t.percent).toFixed(2);let e=this.setResponse("setDownloadInfo",{value:this.downloadInfo});this.sendToChildIframe(e,r),console.log("percentage: "+Number(t.percent).toFixed(2))}}),i["ipcRenderer"].on("updateDownloaded",(e,t)=>{console.log("UPDATE FINISHED:"+JSON.stringify(t));let n=this.setResponse("notification",{type:"success",message:"Download Finished, installing ...",title:""});this.sendToChildIframe(n,r),n=this.setResponse("setDownloadingUpdate",{value:!1}),n=this.setResponse("setInstalling",{value:!0})}),i["ipcRenderer"].send("checkForUpdate",o.data.autoDownload,o.data.forceUpdate,o.data.path);else if(o&&"downloadUpdate"==o.command)i["ipcRenderer"].send("download-update",{filename:o.data.filename,sha512:o.data.sha512}),i["ipcRenderer"].on("download-update-progress",(e,t)=>{if(this.downloadInfo<t){this.downloadInfo=Number(t).toFixed(2);let e=this.setResponse("setDownloadInfo",{value:this.downloadInfo});this.sendToChildIframe(e,r),console.log("percentage: "+t)}}),i["ipcRenderer"].once("download-update-error",(e,t)=>{i["ipcRenderer"].removeAllListeners("download-update-success"),i["ipcRenderer"].removeAllListeners("download-update-progress");let n=this.setResponse("setCheckingForUpdate",{value:!1});this.sendToChildIframe(n,r),n=this.setResponse("setDownloadingUpdate",{value:!1}),this.sendToChildIframe(n,r),this.downloadInfo=0,n=this.setResponse("setDownloadInfo",{value:this.downloadInfo}),this.sendToChildIframe(n,r),n=this.setResponse("notification",{type:"error",message:"Download failed: "+t,title:""}),this.sendToChildIframe(n,r)}),i["ipcRenderer"].once("download-update-success",(e,t,n)=>{i["ipcRenderer"].removeAllListeners("download-update-error"),i["ipcRenderer"].removeAllListeners("download-update-progress"),console.log("Downloaded file:"+t);let s=this.setResponse("notification",{type:"success",message:n,title:""});this.sendToChildIframe(s,r),s=this.setResponse("setCheckingForUpdate",{value:!1}),this.sendToChildIframe(s,r),s=this.setResponse("setDownloadingUpdate",{value:!1}),this.sendToChildIframe(s,r),this.downloadInfo=0,s=this.setResponse("setDownloadInfo",{value:this.downloadInfo}),this.sendToChildIframe(s,r),i["ipcRenderer"].send("checkForUpdate",!0,!0,t)});else if(o&&"setAuthDetails"==o.command)this.setAuthDetails(o.data.data);else if(o&&"print"==o.command){const e=new f["a"];for(var p=0;p<o.data.receipts.length;p++){const t=await e.acquire();var u=Date.now(),h=o.data.receipts[p],m=o.data.receipts[p]._type&&"pdf"===o.data.receipts[p]._type?"printPDF":"print";if(0==h.automaticPrint)await X.showPrinterDialog({title:"Printing Paused",body:"Click Print when you are ready to print",confirmationTitle:"Print"}).then(async e=>{if(e){if(!h.printFile&&!h.urlHTML){let e=this.setResponse("handlePrint",{type:"error",message:"Something went wrong when printing FDE",title:"Printing Error"});return null!=t&&t(),void this.sendToChildIframe(e,r)}i["ipcRenderer"].send(m,{receipt:h,printer:await b.get("printer"),id:u})}});else{if(!h.printFile&&!h.urlHTML){let e=this.setResponse("handlePrint",{type:"error",message:"Something went wrong when printing FDE",title:"Printing Error"});return null!=t&&t(),void this.sendToChildIframe(e,r)}i["ipcRenderer"].send(m,{receipt:h,printer:await b.get("printer"),id:u})}i["ipcRenderer"].on("printError",(e,n,s,i)=>{if(u==n)if(null!=t&&t(),i.includes("No Printer specified")){let e=this.setResponse("handlePrint",{type:"error",message:"No Printer was Chosen",title:"Error"});this.sendToChildIframe(e,r)}else if(i.includes("Printer is Offline")){let e=this.setResponse("handlePrint",{type:"error",message:"Printer is Offline",title:"Error"});this.sendToChildIframe(e,r)}else{let e=this.setResponse("handlePrint",{type:"error",message:"Something went wrong when printing",title:"Error",hideLoader:p===o.data.receipts.length});this.sendToChildIframe(e,r)}}),i["ipcRenderer"].on("printSuccess",(e,n)=>{if(u==n){if(null!=t&&t(),null!=h.uploadReceiptTransactionId&&""!=h.uploadReceiptTransactionId){let e=this.setResponse("showUploadDialog",{uploadReceiptTransactionId:h.uploadReceiptTransactionId});this.sendToChildIframe(e,"globalActions")}let e=this.setResponse("handlePrint",{type:"success",message:"Job has been sent to printer",title:"Printing Sent",hideLoader:p===o.data.receipts.length});this.sendToChildIframe(e,r)}})}}else if(o&&"export"==o.command)i["ipcRenderer"].send("export-as-pdf",{receipts:o.data.receipts,printer:await b.get("printer"),id:Date.now()}),i["ipcRenderer"].on("exportSuccess",()=>{let e=this.setResponse("handlePrint",{type:"success",message:"Files has been exported to downloads",title:"Export Success",hideLoader:!0});this.sendToChildIframe(e,r)}),i["ipcRenderer"].on("exportFailed",()=>{let e=this.setResponse("handlePrint",{type:"error",message:"Files failed to export",title:"Export Failed",hideLoader:!0});this.sendToChildIframe(e,r)});else if(o&&"scan"==o.command){let e,t;var v=d.a.uniqueId();i["ipcRenderer"].send("scan",{scanId:v,scanner:await b.get("scanner"),scannerResolution:o.data.scannerResolution},o.data.useNewScanner),i["ipcRenderer"].once("scanSuccess",(n,s,o)=>{if(s===v){let n=this.setResponse("notification",{type:"success",message:"Scanning finished successfully",title:""});this.sendToChildIframe(n,r);var a=g.a.readFileSync(o);let s=new Buffer(a).toString("base64");n=this.setResponse("sendScannedFilePath",{path:o,base64:s}),i["ipcRenderer"].removeListener("scanError",e),i["ipcRenderer"].removeListener("scanAction",t),this.sendToChildIframe(n,r)}});let n=this;e=function(t,s,o,a){if(s===v){let t={type:"error",message:o,title:"Scan Error"},s=n.setResponse("notification",t);n.sendToChildIframe(s,r),console.error("Error: "+o),a&&(s=n.setResponse("goToPage",{page:"/settings"}),n.sendToChildIframe(s,r)),s=n.setResponse("scanFileFailed",t),i["ipcRenderer"].removeListener("scanError",e),n.sendToChildIframe(s,r)}},i["ipcRenderer"].on("scanError",e),t=function(e,s){if(s===v){let e=n.setResponse("scanFileAction",{});i["ipcRenderer"].removeListener("scanAction",t),n.sendToChildIframe(e,r)}},i["ipcRenderer"].on("scanAction",t)}else if(o&&"removeScannedFile"==o.command)n("9b0f").unlinkSync(o.data.filePath);else if(o&&"updateAvailable"==o.command)sessionStorage.setItem("gettingUpdate",!0);else if(o&&"registeredServiceWorker"==o.command)this.registeredServiceWorker=!0;else if(o&&"copyFile"==o.command)if(g.a.existsSync(o.data1)){g.a.copyFileSync(o.data1,o.data2);let e=this.setResponse("handleFile",{type:"success",message:"File has been copied sucessfully",title:"Copy Success",hideLoader:!0});this.sendToChildIframe(e,r)}else{let e=this.setResponse("handleFile",{type:"error",message:"Failed to copy file",title:"Copy Fail",hideLoader:!0});this.sendToChildIframe(e,r)}else if(o&&"renameFile"==o.command)if(g.a.existsSync(o.data1)){g.a.renameSync(o.data1,o.data2);let e=this.setResponse("handleFile",{type:"success",message:"File has been renamed sucessfully",title:"Rename Success",hideLoader:!0});this.sendToChildIframe(e,r)}else{let e=this.setResponse("handleFile",{type:"error",message:"Failed to rename file",title:"Rename Fail",hideLoader:!0});this.sendToChildIframe(e,r)}else if(o&&"deleteFile"==o.command)if(g.a.existsSync(o.data1)){g.a.unlinkSync(o.data1);let e=this.setResponse("handleFile",{type:"success",message:"File has been deleted sucessfully",title:"Delete Success",hideLoader:!0});this.sendToChildIframe(e,r)}else{let e=this.setResponse("handleFile",{type:"error",message:"Failed to delete file",title:"Delete Fail",hideLoader:!0});this.sendToChildIframe(e,r)}else if(o&&"createFile"==o.command)if(g.a.existsSync(o.data1)){let e=this.setResponse("handleFile",{type:"error",message:"Failed to create file",title:"Create Fail",hideLoader:!0});this.sendToChildIframe(e,r)}else{g.a.writeFileSync(o.data1,o.data2);let e=this.setResponse("handleFile",{type:"success",message:"File has been created sucessfully",title:"Create Success",hideLoader:!0});this.sendToChildIframe(e,r)}}}}},ue=pe,he=(n("034f"),Object(U["a"])(ue,o,r,!1,null,null,null)),fe=he.exports,me=n("8c4f");s["a"].use(me["a"]);const ge=[],ve=new me["a"]({routes:ge});var we=ve;s["a"].config.productionTip=!1,new s["a"]({router:we,store:A,render:e=>e(fe)}).$mount("#app")},"6e70":function(e,t,n){e.exports=n.p+"img/loader.41b762a8.svg"},"6f3a":function(e,t){e.exports=require("url")},"74ae":function(e,t,n){"use strict";n("b4ad")},"845f":function(e,t,n){},"85ec":function(e,t,n){},"8cad":function(e,t){e.exports=require("util")},"8e57":function(e,t){e.exports=require("os")},9224:function(e){e.exports=JSON.parse('{"name":"whishmoney","version":"1.7.4","private":true,"scripts":{"serve":"vue-cli-service serve","build":"vue-cli-service build","lint":"vue-cli-service lint","electron:build:live":"nvm use 14.17.3 && vue-cli-service electron:build --mode production -w --x64 --ia32 -p \'always\'","electron:build:dev":"nvm use 14.17.3 && vue-cli-service electron:build --mode development -w --x64 --ia32 -p \'always\'","electron:serve:live":"nvm use 14.17.3 && vue-cli-service electron:serve --mode production","electron:serve:dev":"nvm use 14.17.3 && vue-cli-service electron:serve --mode development","postinstall":"electron-builder install-app-deps","postuninstall":"electron-builder install-app-deps"},"author":"Walid Itani - Tecfrac","license":"TecFrac","description":"Web Browser","main":"background.js","dependencies":{"appdata-path":"^1.0.0","async-mutex":"^0.3.2","core-js":"^3.6.5","electron-log":"^4.4.5","electron-updater":"^4.3.4","json2csv":"^4.5.4","lodash":"^4.17.15","mustache":"^3.2.1","node-machine-id":"^1.1.12","pdf-merger-js":"^4.2.0","systeminformation":"^4.21.0","vue":"^2.6.11","vue-router":"^3.2.0","vuex":"^3.4.0"},"devDependencies":{"@vue/cli-plugin-babel":"~4.5.0","@vue/cli-plugin-eslint":"~4.5.0","@vue/cli-plugin-router":"~4.5.0","@vue/cli-plugin-vuex":"~4.5.0","@vue/cli-service":"~4.5.0","babel-eslint":"^10.1.0","electron":"^21.0.0","electron-devtools-installer":"^3.1.0","eslint":"^6.7.2","eslint-plugin-vue":"^6.2.2","vue-cli-plugin-electron-builder":"~2.1.1","vue-template-compiler":"^2.6.11","pdf-merger-js":"^4.2.0"}}')},"9b0f":function(e,t){e.exports=require("fs")},"9ce0":function(e,t,n){},a32b:function(e,t){e.exports=require("path")},aed0:function(e,t,n){"use strict";n("9ce0")},b4ad:function(e,t,n){},d2a7:function(e,t,n){},ed62:function(e,t){e.exports=require("https")},f319:function(e,t){e.exports=require("querystring")},ff4a:function(e,t){e.exports=require("events")}});
//# sourceMappingURL=app.38d6b1f4.js.